<?hsp
function hashPwd(pwd) {
    var hash = module("Digest");
    return hash.sha256(pwd + "1919810");
}

function auth(uid, pwd) {
    if (uid <= 0) return false;
    var pre = db.prepare("SELECT `password` FROM `axda-user` WHERE `uid` = ?;");
    pre.set(1, uid);
    var r = pre.executeQuery();
    if (r.length == 0) return false;
    return r[0]["password"] == hashPwd(pwd);
}